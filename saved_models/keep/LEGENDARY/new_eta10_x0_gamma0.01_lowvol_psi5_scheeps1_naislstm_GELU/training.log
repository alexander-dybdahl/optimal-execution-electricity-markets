Distributed training setup: RANK: 0, WORLD_SIZE=4, MASTER_ADDR=idun-01-06, MASTER_PORT=45311
Running on device: cuda, Global rank: 0, Distributed: True, Main process: True
Loading dynamics config from saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU/dynamics_config.json
------------------------------------------------------------
DYNAMICS CONFIGURATION:
------------------------------------------------------------
dynamics: FullDynamics
T: 1.0
N: 72
dim: 3
dim_W: 2
y0: [0.0, 80.0, 0.0]
mu_P: 0.0
mu_D: 0.0
time_dep_vol: True
use_exact: True
low_vol: False
sigma_P0: 10
sigma_P1: 20
alpha_P: 120.0
beta_P: 40.0
sigma_D0: 30.0
sigma_D1: 50.0
alpha_D: 1600.0
beta_D: 900.0
rho: -0.6
psi: 5.0
gamma: 0.01
nu: 0.042
eta: 10
smooth_control: True
eps: 1.0
schedule_epsilon: True
eps_decay_factor: 0.95
eps_update_every: 200
analytical_known: True
dt: 0.013888888888888888
------------------------------------------------------------
Attempting to load model from saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU
No model checkpoint file found in saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU
    Expected files: model_best.pth or model_latest.pth
Starting training from scratch.
Saving configuration files...
Configuration saved to saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU
Applying DDP for parallel training.
Training started at 2025-06-30 23:05:58
Logging training to saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU/training.log
   Epoch |      Y val |      q val | Total loss |     Y loss |    T. loss |   cost loss |         LR |        Eps |  Memory [MB] | Time [s] |        ETA | Status              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
       1 |   7.74e+08 |   1.74e+07 |   1.99e+11 |   2.58e+07 |   3.31e+10 |    1.66e+07 |   1.00e-02 |   1.00e+00 |      3219.13 |     8.71 |        N/A | Model saved (best)  
      50 |   3.79e+08 |   1.16e+07 |   9.21e+10 |   1.38e+07 |   1.53e+10 |    7.67e+06 |   1.00e-02 |   1.00e+00 |      3831.50 |   149.33 |    50m 02s | Model saved (best)  
     100 |   9.27e+07 |   5.42e+06 |   2.24e+10 |   3.51e+06 |   3.72e+09 |    1.87e+06 |   1.00e-02 |   1.00e+00 |      3831.50 |   150.51 |    46m 17s | Model saved (best)  
     150 |   9.92e+07 |   1.68e+06 |   3.71e+09 |   3.70e+05 |   5.57e+08 |    3.15e+05 |   1.00e-02 |   1.00e+00 |      5299.50 |   182.21 |    46m 21s | Model saved (best)  
     200 |   7.44e+07 |   1.38e+05 |   1.91e+08 |   8.13e+05 |   6.38e+07 |    1.27e+04 |   1.00e-02 |   9.50e-01 |      5299.50 |   150.42 |    42m 44s | Model saved (best)  
     250 |   4.37e+06 |   3.48e+04 |   2.90e+07 |   7.51e+05 |   8.56e+06 |    1.97e+03 |   1.00e-02 |   9.50e-01 |      5301.60 |   179.02 |    41m 00s | Model saved (best)  
     300 |   9.92e+05 |   2.28e+04 |   1.49e+07 |   5.15e+05 |   2.76e+06 |    1.17e+03 |   1.00e-02 |   9.50e-01 |      5301.60 |   147.55 |    37m 38s | Model saved (best)  
     350 |   5.06e+05 |   1.90e+04 |   1.04e+07 |   5.16e+05 |   1.47e+06 |    8.38e+02 |   1.00e-02 |   9.50e-01 |      5303.70 |   178.15 |    35m 28s | Model saved (best)  
     400 |   4.59e+05 |   1.57e+04 |   7.77e+06 |   4.93e+05 |   1.09e+06 |    6.19e+02 |   1.00e-02 |   9.02e-01 |      5303.70 |   146.70 |    32m 18s | Model saved (best)  
     450 |   4.44e+05 |   1.46e+04 |   6.87e+06 |   4.89e+05 |   9.60e+05 |    5.42e+02 |   1.00e-02 |   9.02e-01 |      5305.79 |   177.74 |    29m 57s | Model saved (best)  
     500 |   4.55e+05 |   1.50e+04 |   6.62e+06 |   5.30e+05 |   8.84e+05 |    5.21e+02 |   1.00e-02 |   9.02e-01 |      5305.79 |   145.46 |    26m 55s | Model saved (best)  
     550 |   4.37e+05 |   1.39e+04 |   5.95e+06 |   5.21e+05 |   8.03e+05 |    4.62e+02 |   1.00e-02 |   9.02e-01 |      5305.79 |   176.19 |    24m 26s | Model saved (best)  
     600 |   4.21e+05 |   1.30e+04 |   5.47e+06 |   4.98e+05 |   7.51e+05 |    4.22e+02 |   1.00e-02 |   8.57e-01 |      5305.79 |   145.51 |    21m 31s | Model saved (best)  
     650 |   4.67e+05 |   1.50e+04 |   5.97e+06 |   6.16e+05 |   7.51e+05 |    4.60e+02 |   1.00e-02 |   8.57e-01 |      5305.79 |   175.80 |    18m 57s | Model saved         
     700 |   4.17e+05 |   1.25e+04 |   4.98e+06 |   4.86e+05 |   6.81e+05 |    3.82e+02 |   1.00e-02 |   8.57e-01 |      5305.79 |   144.33 |    16m 07s | Model saved (best)  
     750 |   4.04e+05 |   1.23e+04 |   4.75e+06 |   4.94e+05 |   6.44e+05 |    3.62e+02 |   1.00e-02 |   8.57e-01 |      5305.79 |   175.01 |    13m 30s | Model saved (best)  
     800 |   4.90e+05 |   1.62e+04 |   6.13e+06 |   6.49e+05 |   7.23e+05 |    4.76e+02 |   1.00e-02 |   8.15e-01 |      5305.79 |   144.51 |    10m 44s | Model saved         
     850 |   4.12e+05 |   1.23e+04 |   4.62e+06 |   4.98e+05 |   6.13e+05 |    3.51e+02 |   1.00e-02 |   8.15e-01 |      5305.79 |   172.71 |     8m 05s | Model saved (best)  
     900 |   4.32e+05 |   1.33e+04 |   4.89e+06 |   5.60e+05 |   6.13e+05 |    3.71e+02 |   1.00e-02 |   8.15e-01 |      5305.79 |   133.06 |     5m 20s | Model saved         
     950 |   3.99e+05 |   1.18e+04 |   4.23e+06 |   4.99e+05 |   5.58e+05 |    3.18e+02 |   1.00e-02 |   8.15e-01 |      5305.79 |   161.20 |     2m 40s | Model saved (best)  
    1000 |   3.85e+05 |   1.13e+04 |   3.96e+06 |   4.75e+05 |   5.39e+05 |    2.95e+02 |   1.00e-02 |   7.74e-01 |      5305.79 |   132.71 |         0s | Model saved (best)  
Training completed. Lowest loss: 294.570819. Total time: 3211.14 seconds
Model saved to saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU/model.pth
================================================================================
RESUMING TRAINING - APPENDING TO EXISTING LOG
================================================================================
Distributed training setup: RANK: 0, WORLD_SIZE=4, MASTER_ADDR=idun-01-06, MASTER_PORT=33699
Running on device: cuda, Global rank: 0, Distributed: True, Main process: True
Loading dynamics config from saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU/dynamics_config.json
------------------------------------------------------------
DYNAMICS CONFIGURATION:
------------------------------------------------------------
dynamics: FullDynamics
T: 1.0
N: 144
dim: 3
dim_W: 2
y0: [0.0, 80.0, 0.0]
mu_P: 0.0
mu_D: 0.0
time_dep_vol: True
use_exact: True
low_vol: False
sigma_P0: 10
sigma_P1: 20
alpha_P: 120.0
beta_P: 40.0
sigma_D0: 30.0
sigma_D1: 50.0
alpha_D: 1600.0
beta_D: 900.0
rho: -0.6
psi: 5.0
gamma: 0.01
nu: 0.042
eta: 10
smooth_control: True
eps: 0.7737809375
schedule_epsilon: True
eps_decay_factor: 0.95
eps_update_every: 200
analytical_known: True
dt: 0.006944444444444444
------------------------------------------------------------
Attempting to load model from saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU
Found existing model files: ['model_best.pth', 'model.pth']
Successfully loaded model checkpoint from epoch 1000 with training state
Saving configuration files...
Configuration saved to saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU
Applying DDP for parallel training.
Training started at 2025-07-01 00:44:07
Logging training to saved_models/new_eta10_x0_gamma0.01_lowvol_psi5_scheeps1_naislstm_GELU/training.log
   Epoch |      Y val |      q val | Total loss |     Y loss |    T. loss |   cost loss |         LR |        Eps |  Memory [MB] | Time [s] |        ETA | Status              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Resuming training from epoch 1001/100000
Current learning rate: 1.000000e-02
Lowest loss so far: 3.175976e+02
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    1050 |   3.51e+05 |   1.38e+04 |   3.21e+06 |   1.28e+05 |   4.72e+05 |    2.61e+02 |   1.00e-02 |   7.74e-01 |      7568.62 |   324.16 | 10691m 43s | Model saved (best)  
    1100 |   3.30e+05 |   1.30e+04 |   2.97e+06 |   1.30e+05 |   4.58e+05 |    2.38e+02 |   1.00e-02 |   7.74e-01 |      7568.62 |   322.06 | 10651m 53s | Model saved (best)  
    1150 |   3.24e+05 |   1.27e+04 |   2.85e+06 |   1.29e+05 |   4.49e+05 |    2.27e+02 |   1.00e-02 |   7.74e-01 |     10487.86 |   358.69 | 11037m 18s | Model saved (best)  
    1200 |   3.26e+05 |   1.27e+04 |   2.85e+06 |   1.33e+05 |   4.49e+05 |    2.27e+02 |   1.00e-02 |   7.35e-01 |     10487.86 |   322.88 | 10932m 12s | Model saved (best)  
    1250 |   3.00e+05 |   1.14e+04 |   2.44e+06 |   1.24e+05 |   4.19e+05 |    1.90e+02 |   1.00e-02 |   7.35e-01 |     10487.86 |   356.22 | 11086m 27s | Model saved (best)  
    1300 |   3.19e+05 |   1.25e+04 |   2.65e+06 |   1.36e+05 |   4.26e+05 |    2.09e+02 |   1.00e-02 |   7.35e-01 |     10487.86 |   319.56 | 10986m 17s | Model saved         
    1350 |   3.07e+05 |   1.20e+04 |   2.44e+06 |   1.30e+05 |   4.16e+05 |    1.90e+02 |   1.00e-02 |   7.35e-01 |     10487.86 |   354.18 | 11075m 51s | Model saved (best)  
    1400 |   2.79e+05 |   1.01e+04 |   1.95e+06 |   1.09e+05 |   3.98e+05 |    1.44e+02 |   1.00e-02 |   6.98e-01 |     10487.86 |   317.76 | 10991m 56s | Model saved (best)  
    1450 |   2.73e+05 |   9.66e+03 |   1.78e+06 |   1.08e+05 |   3.88e+05 |    1.28e+02 |   1.00e-02 |   6.98e-01 |     10487.86 |   352.00 | 11050m 27s | Model saved (best)  
    1500 |   4.11e+05 |   1.83e+04 |   4.18e+06 |   2.20e+05 |   5.32e+05 |    3.43e+02 |   1.00e-02 |   6.98e-01 |     10487.86 |   315.52 | 10976m 20s | Model saved         
    1550 |   3.62e+05 |   1.59e+04 |   3.30e+06 |   1.91e+05 |   4.43e+05 |    2.67e+02 |   1.00e-02 |   6.98e-01 |     10489.95 |   338.22 | 10982m 27s | Model saved         
    1600 |   3.23e+05 |   1.35e+04 |   2.73e+06 |   1.53e+05 |   4.11e+05 |    2.16e+02 |   1.00e-02 |   6.63e-01 |     10489.95 |   304.80 | 10895m 15s | Model saved         
    1650 |   3.09e+05 |   1.25e+04 |   2.42e+06 |   1.41e+05 |   3.99e+05 |    1.88e+02 |   9.50e-03 |   6.63e-01 |     10489.95 |   337.73 | 10903m 44s | Model saved         
    1700 |   3.53e+05 |   1.49e+04 |   3.06e+06 |   1.67e+05 |   4.39e+05 |    2.45e+02 |   9.50e-03 |   6.63e-01 |     10489.95 |   301.46 | 10825m 18s | Model saved         
    1750 |   3.56e+05 |   1.48e+04 |   3.11e+06 |   1.65e+05 |   4.48e+05 |    2.49e+02 |   9.50e-03 |   6.63e-01 |     10489.95 |   339.85 | 10840m 30s | Model saved         
    1800 |   3.06e+05 |   1.22e+04 |   2.20e+06 |   1.31e+05 |   3.92e+05 |    1.68e+02 |   9.50e-03 |   6.30e-01 |     10489.95 |   301.85 | 10775m 20s | Model saved         
    1850 |   3.66e+05 |   1.63e+04 |   3.40e+06 |   2.06e+05 |   4.26e+05 |    2.77e+02 |   9.03e-03 |   6.30e-01 |     10489.95 |   337.69 | 10786m 13s | Model saved         
    1900 |   3.00e+05 |   1.22e+04 |   2.34e+06 |   1.44e+05 |   3.75e+05 |    1.82e+02 |   9.03e-03 |   6.30e-01 |     10489.95 |   301.48 | 10729m 30s | Model saved         
    1950 |   3.31e+05 |   1.40e+04 |   2.63e+06 |   1.64e+05 |   4.02e+05 |    2.06e+02 |   9.03e-03 |   6.30e-01 |     10489.95 |   337.85 | 10740m 47s | Model saved         
    2000 |   3.22e+05 |   1.41e+04 |   2.91e+06 |   1.61e+05 |   4.53e+05 |    2.30e+02 |   9.03e-03 |   5.99e-01 |     10489.95 |   302.10 | 10691m 59s | Model saved         
    2050 |   3.01e+05 |   1.23e+04 |   2.33e+06 |   1.55e+05 |   4.05e+05 |    1.77e+02 |   8.57e-03 |   5.99e-01 |     10489.95 |   344.74 | 10713m 38s | Model saved         
    2100 |   3.64e+05 |   1.53e+04 |   3.25e+06 |   2.01e+05 |   4.60e+05 |    2.58e+02 |   8.57e-03 |   5.99e-01 |     10489.95 |   301.37 | 10668m 28s | Model saved         
