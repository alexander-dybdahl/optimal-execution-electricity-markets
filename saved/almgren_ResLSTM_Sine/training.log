Training started at 2025-05-29 14:57:38
Logging training to saved/almgren_ResLSTM_Sine\training.log

+---------------------------+---------------------------+
| Training Configuration    |                           |
+---------------------------+---------------------------+
| Epochs                    | 5000                      |
| Learning Rate             | 0.001                     |
| Adaptive LR               | True                      |
| lambda_Y (Y loss)         | 1                         |
| lambda_T (Terminal loss)  | 1                         |
| lambda_TG (Gradient loss) | 1                         |
| Number of Paths           | 1024                      |
| Batch Size                | 1024                      |
| Architecture              | ResLSTM                   |
| Depth                     | 9                         |
| Width                     | 256                       |
| Activation                | Sine                      |
| T                         | 1.0                       |
| N                         | 200                       |
| Supervised                | True                      |
+---------------------------+---------------------------+

   Epoch |   Total loss |       Y loss |      T. loss |    T.G. loss |         LR |  Memory [MB] | Time [s] |      ETA | Status              
-------------------------------------------------------------------------------------------------------------------------------------------
       0 |     6.43e+00 |     2.38e+00 |     2.74e+00 |     1.31e+00 |   1.00e-03 |       123.73 |     0.41 |      N/A | Model saved (best)  
      50 |     2.85e+00 |     1.37e+00 |     9.32e-01 |     5.56e-01 |   1.00e-03 |       123.73 |     3.57 |   6m 41s | Model saved (best)  
     100 |     1.04e+00 |     6.16e-01 |     2.49e-01 |     1.72e-01 |   1.00e-03 |       123.73 |     3.62 |   6m 18s | Model saved (best)  
     150 |     1.93e-01 |     9.75e-02 |     5.22e-02 |     4.32e-02 |   1.00e-03 |       123.73 |     4.15 |   6m 26s | Model saved (best)  
     200 |     1.21e-01 |     5.48e-02 |     3.93e-02 |     2.69e-02 |   1.00e-03 |       123.73 |     5.12 |   6m 54s | Model saved (best)  
     250 |     9.18e-02 |     4.20e-02 |     2.76e-02 |     2.22e-02 |   1.00e-03 |       123.73 |     4.90 |   7m 02s | Model saved (best)  
     300 |     7.04e-02 |     3.20e-02 |     2.21e-02 |     1.63e-02 |   1.00e-03 |       123.73 |     3.47 |   6m 43s | Model saved (best)  
     350 |     8.65e-02 |     3.78e-02 |     3.11e-02 |     1.76e-02 |   1.00e-03 |       123.73 |     3.89 |   6m 34s | Model saved         
     400 |     6.94e-02 |     2.71e-02 |     2.58e-02 |     1.66e-02 |   1.00e-03 |       123.73 |     3.93 |   6m 27s | Model saved (best)  
     450 |     4.19e-02 |     2.04e-02 |     1.21e-02 |     9.44e-03 |   1.00e-03 |       123.73 |     3.87 |   6m 20s | Model saved (best)  
     500 |     4.69e-02 |     1.99e-02 |     1.82e-02 |     8.82e-03 |   1.00e-03 |       123.73 |     3.74 |   6m 12s | Model saved         
     550 |     5.06e-02 |     2.13e-02 |     1.90e-02 |     1.03e-02 |   1.00e-03 |       123.73 |     3.53 |   6m 03s | Model saved         
     600 |     2.12e-02 |     8.49e-03 |     6.66e-03 |     6.05e-03 |   1.00e-03 |       123.73 |     3.52 |   5m 55s | Model saved (best)  
     650 |     4.25e-02 |     1.33e-02 |     1.90e-02 |     1.02e-02 |   1.00e-03 |       123.73 |     3.57 |   5m 48s | Model saved         
     700 |     5.14e-02 |     2.26e-02 |     1.78e-02 |     1.10e-02 |   1.00e-03 |       123.73 |     3.70 |   5m 43s | Model saved         
     750 |     2.24e-02 |     1.09e-02 |     6.80e-03 |     4.73e-03 |   1.00e-03 |       123.73 |     3.49 |   5m 36s | Model saved         
     800 |     2.77e-02 |     1.04e-02 |     1.09e-02 |     6.43e-03 |   1.00e-03 |       123.73 |     4.06 |   5m 33s | Model saved         
     850 |     2.82e-02 |     8.75e-03 |     1.18e-02 |     7.68e-03 |   1.00e-03 |       123.73 |     4.03 |   5m 29s | Model saved         
     900 |     5.06e-02 |     2.27e-02 |     1.81e-02 |     9.85e-03 |   1.00e-03 |       123.73 |     4.13 |   5m 26s | Model saved         
     950 |     1.43e-02 |     6.54e-03 |     4.06e-03 |     3.68e-03 |   1.00e-03 |       123.73 |     3.80 |   5m 21s | Model saved (best)  
    1000 |     1.74e-02 |     5.22e-03 |     6.99e-03 |     5.18e-03 |   1.00e-03 |       123.73 |     3.91 |   5m 18s | Model saved         
    1050 |     1.52e-01 |     6.74e-02 |     5.71e-02 |     2.76e-02 |   1.00e-03 |       123.73 |     4.17 |   5m 15s | Model saved         
    1100 |     1.84e-02 |     9.40e-03 |     4.23e-03 |     4.72e-03 |   1.00e-03 |       123.73 |     4.17 |   5m 12s | Model saved         
    1150 |     1.36e-02 |     5.38e-03 |     5.19e-03 |     3.07e-03 |   1.00e-03 |       123.73 |     4.14 |   5m 08s | Model saved (best)  
    1200 |     1.12e-02 |     4.03e-03 |     3.70e-03 |     3.46e-03 |   1.00e-03 |       123.73 |     3.84 |   5m 04s | Model saved (best)  
    1250 |     3.21e-02 |     9.88e-03 |     1.39e-02 |     8.29e-03 |   1.00e-03 |       123.73 |     4.13 |   5m 00s | Model saved         
    1300 |     1.88e-02 |     5.75e-03 |     8.25e-03 |     4.78e-03 |   1.00e-03 |       123.73 |     3.89 |   4m 56s | Model saved         
    1350 |     8.34e-02 |     3.58e-02 |     3.34e-02 |     1.43e-02 |   1.00e-03 |       123.73 |     4.22 |   4m 53s | Model saved         
    1400 |     1.59e-02 |     5.45e-03 |     5.59e-03 |     4.84e-03 |   8.00e-04 |       123.73 |     4.17 |   4m 49s | Model saved         
    1450 |     8.79e-03 |     3.35e-03 |     2.32e-03 |     3.12e-03 |   8.00e-04 |       123.73 |     3.90 |   4m 45s | Model saved (best)  
    1500 |     4.39e-03 |     1.84e-03 |     1.04e-03 |     1.51e-03 |   8.00e-04 |       123.73 |     4.08 |   4m 41s | Model saved (best)  
    1550 |     4.72e-03 |     1.88e-03 |     1.17e-03 |     1.67e-03 |   8.00e-04 |       123.73 |     3.94 |   4m 37s | Model saved         
    1600 |     5.46e-03 |     1.93e-03 |     1.78e-03 |     1.74e-03 |   8.00e-04 |       123.73 |     3.85 |   4m 33s | Model saved         
    1650 |     4.94e-03 |     1.75e-03 |     1.59e-03 |     1.59e-03 |   8.00e-04 |       123.73 |     3.96 |   4m 29s | Model saved         
    1700 |     5.79e-03 |     2.31e-03 |     1.94e-03 |     1.53e-03 |   8.00e-04 |       123.73 |     3.70 |   4m 24s | Model saved         
    1750 |     9.88e-03 |     3.14e-03 |     3.83e-03 |     2.91e-03 |   8.00e-04 |       123.73 |     4.30 |   4m 21s | Model saved         
    1800 |     3.38e-03 |     1.55e-03 |     8.77e-04 |     9.52e-04 |   6.40e-04 |       123.73 |     4.48 |   4m 18s | Model saved (best)  
    1850 |     4.76e-03 |     1.26e-03 |     1.43e-03 |     2.07e-03 |   6.40e-04 |       123.73 |     3.69 |   4m 13s | Model saved         
    1900 |     2.97e-03 |     1.20e-03 |     7.42e-04 |     1.02e-03 |   6.40e-04 |       123.73 |     4.11 |   4m 09s | Model saved (best)  
    1950 |     4.68e-03 |     1.29e-03 |     1.65e-03 |     1.74e-03 |   6.40e-04 |       123.73 |     3.92 |   4m 05s | Model saved         
    2000 |     4.58e-03 |     7.92e-04 |     1.45e-03 |     2.33e-03 |   6.40e-04 |       123.73 |     4.22 |   4m 01s | Model saved         
    2050 |     7.52e-03 |     2.03e-03 |     3.21e-03 |     2.28e-03 |   6.40e-04 |       123.73 |     4.04 |   3m 57s | Model saved         
    2100 |     4.20e-03 |     2.03e-03 |     1.39e-03 |     7.74e-04 |   6.40e-04 |       123.73 |     3.81 |   3m 53s | Model saved         
    2150 |     3.69e-03 |     1.34e-03 |     1.24e-03 |     1.11e-03 |   6.40e-04 |       123.73 |     3.66 |   3m 49s | Model saved         
    2200 |     1.05e-02 |     4.77e-03 |     4.03e-03 |     1.75e-03 |   6.40e-04 |       123.73 |     4.12 |   3m 45s | Model saved         
    2250 |     1.30e-02 |     3.52e-03 |     6.08e-03 |     3.37e-03 |   6.40e-04 |       123.73 |     4.03 |   3m 41s | Model saved         
    2300 |     4.28e-03 |     1.53e-03 |     1.67e-03 |     1.08e-03 |   6.40e-04 |       123.73 |     3.44 |   3m 36s | Model saved         
    2350 |     4.39e-03 |     1.19e-03 |     1.53e-03 |     1.66e-03 |   5.12e-04 |       123.73 |     3.79 |   3m 32s | Model saved         
    2400 |     2.61e-03 |     1.06e-03 |     7.46e-04 |     8.00e-04 |   5.12e-04 |       123.73 |     3.95 |   3m 28s | Model saved (best)  
    2450 |     2.13e-03 |     9.79e-04 |     4.89e-04 |     6.66e-04 |   5.12e-04 |       123.73 |     3.88 |   3m 24s | Model saved (best)  
    2500 |     1.90e-03 |     8.38e-04 |     4.14e-04 |     6.50e-04 |   5.12e-04 |       123.73 |     3.81 |   3m 20s | Model saved (best)  
    2550 |     2.81e-03 |     8.28e-04 |     1.16e-03 |     8.26e-04 |   5.12e-04 |       123.73 |     4.00 |   3m 16s | Model saved         
    2600 |     2.97e-03 |     9.02e-04 |     8.08e-04 |     1.26e-03 |   5.12e-04 |       123.73 |     3.66 |   3m 11s | Model saved         
    2650 |     2.05e-03 |     9.04e-04 |     6.06e-04 |     5.42e-04 |   4.10e-04 |       123.73 |     3.82 |   3m 07s | Model saved         
    2700 |     9.60e-04 |     5.00e-04 |     1.91e-04 |     2.68e-04 |   4.10e-04 |       123.73 |     3.79 |   3m 03s | Model saved (best)  
    2750 |     1.28e-03 |     5.33e-04 |     2.29e-04 |     5.22e-04 |   4.10e-04 |       123.73 |     3.97 |   2m 59s | Model saved         
    2800 |     7.41e-04 |     4.10e-04 |     1.25e-04 |     2.06e-04 |   4.10e-04 |       123.73 |     3.50 |   2m 55s | Model saved (best)  
    2850 |     1.96e-03 |     7.12e-04 |     6.02e-04 |     6.51e-04 |   4.10e-04 |       123.73 |     3.68 |   2m 51s | Model saved         
    2900 |     7.33e-03 |     1.85e-03 |     3.33e-03 |     2.14e-03 |   4.10e-04 |       123.73 |     3.91 |   2m 47s | Model saved         
    2950 |     5.35e-03 |     1.72e-03 |     2.21e-03 |     1.42e-03 |   4.10e-04 |       123.73 |     3.55 |   2m 42s | Model saved         
    3000 |     1.64e-03 |     8.20e-04 |     5.07e-04 |     3.12e-04 |   4.10e-04 |       123.73 |     3.71 |   2m 38s | Model saved         
    3050 |     2.07e-03 |     6.96e-04 |     5.60e-04 |     8.17e-04 |   3.28e-04 |       123.73 |     3.70 |   2m 34s | Model saved         
    3100 |     1.71e-03 |     6.56e-04 |     5.23e-04 |     5.32e-04 |   3.28e-04 |       123.73 |     3.62 |   2m 30s | Model saved         
    3150 |     2.16e-03 |     6.11e-04 |     6.99e-04 |     8.50e-04 |   3.28e-04 |       123.73 |     3.62 |   2m 26s | Model saved         
    3200 |     2.56e-03 |     1.02e-03 |     7.10e-04 |     8.28e-04 |   3.28e-04 |       123.73 |     3.98 |   2m 22s | Model saved         
    3250 |     2.06e-03 |     5.57e-04 |     5.73e-04 |     9.28e-04 |   2.62e-04 |       123.73 |     3.70 |   2m 18s | Model saved         
    3300 |     1.07e-03 |     4.00e-04 |     2.34e-04 |     4.34e-04 |   2.62e-04 |       123.73 |     3.93 |   2m 14s | Model saved         
    3350 |     1.42e-03 |     5.26e-04 |     3.51e-04 |     5.38e-04 |   2.62e-04 |       123.73 |     3.92 |   2m 10s | Model saved         
    3400 |     7.13e-04 |     4.02e-04 |     1.33e-04 |     1.78e-04 |   2.62e-04 |       123.73 |     3.95 |   2m 06s | Model saved (best)  
    3450 |     6.18e-04 |     3.42e-04 |     1.10e-04 |     1.65e-04 |   2.62e-04 |       123.73 |     3.87 |   2m 02s | Model saved (best)  
    3500 |     1.27e-03 |     4.11e-04 |     3.26e-04 |     5.30e-04 |   2.62e-04 |       123.73 |     4.15 |   1m 58s | Model saved         
    3550 |     1.25e-03 |     4.65e-04 |     2.97e-04 |     4.90e-04 |   2.62e-04 |       123.73 |     4.04 |   1m 54s | Model saved         
    3600 |     2.43e-03 |     5.60e-04 |     7.89e-04 |     1.08e-03 |   2.62e-04 |       123.73 |     3.91 |   1m 50s | Model saved         
    3650 |     3.09e-03 |     9.43e-04 |     8.33e-04 |     1.31e-03 |   2.10e-04 |       123.73 |     4.04 |   1m 46s | Model saved         
    3700 |     1.43e-03 |     5.66e-04 |     3.38e-04 |     5.27e-04 |   2.10e-04 |       123.73 |     4.18 |   1m 43s | Model saved         
    3750 |     6.81e-04 |     3.78e-04 |     1.10e-04 |     1.92e-04 |   2.10e-04 |       123.73 |     4.15 |   1m 39s | Model saved         
    3800 |     3.01e-03 |     5.85e-04 |     1.41e-03 |     1.01e-03 |   2.10e-04 |       123.73 |     3.99 |   1m 35s | Model saved         
    3850 |     1.25e-03 |     5.15e-04 |     2.42e-04 |     4.96e-04 |   2.10e-04 |       123.73 |     4.26 |   1m 31s | Model saved         
    3900 |     1.29e-03 |     4.66e-04 |     3.53e-04 |     4.76e-04 |   2.10e-04 |       123.73 |     4.19 |   1m 27s | Model saved         
    3950 |     1.90e-03 |     5.19e-04 |     4.99e-04 |     8.77e-04 |   2.10e-04 |       123.73 |     4.07 |   1m 23s | Model saved         
    4000 |     7.69e-04 |     2.96e-04 |     1.60e-04 |     3.13e-04 |   1.68e-04 |       123.73 |     4.14 |   1m 19s | Model saved         
    4050 |     8.64e-04 |     4.47e-04 |     1.90e-04 |     2.27e-04 |   1.68e-04 |       123.73 |     4.52 |   1m 15s | Model saved         
    4100 |     5.97e-04 |     2.97e-04 |     8.96e-05 |     2.11e-04 |   1.68e-04 |       123.73 |     4.15 |   1m 11s | Model saved (best)  
    4150 |     5.05e-04 |     2.99e-04 |     7.78e-05 |     1.28e-04 |   1.68e-04 |       123.73 |     4.25 |   1m 07s | Model saved (best)  
    4200 |     1.53e-03 |     2.91e-04 |     4.55e-04 |     7.82e-04 |   1.68e-04 |       123.73 |     4.29 |   1m 03s | Model saved         
    4250 |     5.21e-04 |     2.77e-04 |     9.58e-05 |     1.49e-04 |   1.68e-04 |       123.73 |     4.35 |      59s | Model saved         
    4300 |     5.78e-04 |     2.91e-04 |     8.74e-05 |     2.00e-04 |   1.68e-04 |       123.73 |     4.14 |      56s | Model saved         
    4350 |     1.52e-03 |     4.92e-04 |     3.97e-04 |     6.29e-04 |   1.68e-04 |       123.73 |     3.67 |      51s | Model saved         
    4400 |     1.49e-03 |     5.19e-04 |     4.24e-04 |     5.43e-04 |   1.68e-04 |       123.73 |     3.85 |      47s | Model saved         
    4450 |     3.80e-03 |     5.96e-04 |     1.96e-03 |     1.25e-03 |   1.68e-04 |       123.73 |     3.86 |      43s | Model saved         
    4500 |     1.08e-03 |     4.12e-04 |     2.83e-04 |     3.87e-04 |   1.34e-04 |       123.73 |     3.92 |      39s | Model saved         
    4550 |     5.78e-04 |     3.65e-04 |     8.68e-05 |     1.26e-04 |   1.34e-04 |       123.73 |     3.77 |      35s | Model saved         
    4600 |     4.61e-04 |     2.17e-04 |     6.36e-05 |     1.81e-04 |   1.34e-04 |       123.73 |     4.02 |      31s | Model saved (best)  
    4650 |     3.99e-04 |     2.27e-04 |     6.68e-05 |     1.06e-04 |   1.34e-04 |       123.73 |     3.85 |      27s | Model saved (best)  
    4700 |     6.01e-04 |     2.51e-04 |     1.19e-04 |     2.31e-04 |   1.34e-04 |       123.73 |     3.88 |      23s | Model saved         
    4750 |     3.80e-04 |     2.17e-04 |     5.84e-05 |     1.04e-04 |   1.34e-04 |       123.73 |     4.04 |      19s | Model saved (best)  
    4800 |     1.57e-03 |     4.19e-04 |     4.01e-04 |     7.55e-04 |   1.34e-04 |       123.73 |     3.99 |      15s | Model saved         
    4850 |     1.35e-03 |     3.93e-04 |     3.75e-04 |     5.84e-04 |   1.07e-04 |       123.73 |     3.85 |      11s | Model saved         
    4900 |     4.55e-04 |     2.17e-04 |     8.68e-05 |     1.51e-04 |   1.07e-04 |       123.73 |     3.94 |       7s | Model saved         
    4950 |     4.13e-04 |     2.26e-04 |     7.31e-05 |     1.14e-04 |   1.07e-04 |       123.73 |     4.17 |       3s | Model saved         
    4999 |     3.30e-04 |     1.95e-04 |     5.02e-05 |     8.53e-05 |   1.07e-04 |       123.78 |     3.82 |       0s | Model saved (best)  
-------------------------------------------------------------------------------------------------------------------------------------------
Training completed. Lowest loss: 0.000330. Total time: 399.29 seconds
Model saved to saved/almgren_ResLSTM_Sine\model.pth
